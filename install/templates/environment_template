# Check that the script is sourced and not executed directly.
if [[ "$0" = "${BASH_SOURCE[0]}" ]]; then
    echo "This script should be sourced, not executed directly. Use 'source environment' (or the relevant path) to source the script."
    exit 1
fi

MINC_TOOLKIT_DIR=%MINC_TOOLKIT_DIR%

# to source the MINC toolkit
source ${MINC_TOOLKIT_DIR}/minc-toolkit-config.sh
umask 0002

# for the defacing scripts
export BEASTLIB=${MINC_TOOLKIT_DIR}/../share/beast-library-1.1
export MNI_MODELS=${MINC_TOOLKIT_DIR}/../share/icbm152_model_09c

# Source the directory of this environment file, which is also the LORIS-MRI directory.
export LORIS_MRI=$(dirname -- "$(readlink -f "${BASH_SOURCE[0]}")")

# export PATH, PERL5LIB, TMPDIR and LORIS_CONFIG variables
export PATH=${LORIS_MRI}:${LORIS_MRI}/uploadNeuroDB:${LORIS_MRI}/uploadNeuroDB/bin:${LORIS_MRI}/dicom-archive:${LORIS_MRI}/python/scripts:${LORIS_MRI}/tools:${LORIS_MRI}/python/react-series-data-viewer:${MINC_TOOLKIT_DIR}/bin:/usr/local/bin/tpcclib:$PATH
export PERL5LIB=${LORIS_MRI}/uploadNeuroDB:${LORIS_MRI}/dicom-archive:$PERL5LIB
export TMPDIR=/tmp
export LORIS_CONFIG=${LORIS_MRI}/config

# Source the LORIS Python virtual environment.
source ${LORIS_MRI}/.venv/bin/activate
